<div class="problem-statement">
 <div class="header">
  <div class="title">
   D. Three Sequences
  </div>
  <div class="time-limit">
   <div class="property-title">
    time limit per test
   </div>2 seconds
  </div>
  <div class="memory-limit">
   <div class="property-title">
    memory limit per test
   </div>512 megabytes
  </div>
  <div class="input-file">
   <div class="property-title">
    input
   </div>standard input
  </div>
  <div class="output-file">
   <div class="property-title">
    output
   </div>standard output
  </div>
 </div>
 <div>
  <p>You are given a sequence of $n$ integers $a_1, a_2, \ldots, a_n$.</p>
  <p>You have to construct two sequences of integers $b$ and $c$ with length $n$ that satisfy:</p>
  <ul> 
   <li> for every $i$ ($1\leq i\leq n$) $b_i+c_i=a_i$ </li>
   <li> $b$ is non-decreasing, which means that for every $1&lt;i\leq n$, $b_i\geq b_{i-1}$ must hold </li>
   <li> $c$ is non-increasing, which means that for every $1&lt;i\leq n$, $c_i\leq c_{i-1}$ must hold </li>
  </ul>
  <p>You have to minimize $\max(b_i,c_i)$. In other words, you have to minimize the maximum number in sequences $b$ and $c$.</p>
  <p>Also there will be $q$ changes, the $i$-th change is described by three integers $l,r,x$. You should add $x$ to $a_l,a_{l+1}, \ldots, a_r$. </p>
  <p>You have to find the minimum possible value of $\max(b_i,c_i)$ for the initial sequence and for sequence after each change.</p>
 </div>
 <div class="input-specification">
  <div class="section-title">
   Input
  </div>
  <p>The first line contains an integer $n$ ($1\leq n\leq 10^5$).</p>
  <p>The secound line contains $n$ integers $a_1,a_2,\ldots,a_n$ ($1\leq i\leq n$, $-10^9\leq a_i\leq 10^9$).</p>
  <p>The third line contains an integer $q$ ($1\leq q\leq 10^5$).</p>
  <p>Each of the next $q$ lines contains three integers $l,r,x$ ($1\leq l\leq r\leq n,-10^9\leq x\leq 10^9$), desribing the next change. </p>
 </div>
 <div class="output-specification">
  <div class="section-title">
   Output
  </div>
  <p>Print $q+1$ lines.</p>
  <p>On the $i$-th ($1 \leq i \leq q+1$) line, print the answer to the problem for the sequence after $i-1$ changes.</p>
 </div>
 <div class="sample-tests">
  <div class="section-title">
   Examples
  </div>
  <div class="sample-test">
   <div class="input">
    <div class="title">
     Input
    </div>
    <pre>
4
2 -1 7 3
2
2 4 -3
3 4 2
</pre>
   </div>
   <div class="output">
    <div class="title">
     Output
    </div>
    <pre>
5
5
6
</pre>
   </div>
   <div class="input">
    <div class="title">
     Input
    </div>
    <pre>
6
-9 -10 -9 -6 -5 4
3
2 6 -9
1 2 -10
4 6 -3
</pre>
   </div>
   <div class="output">
    <div class="title">
     Output
    </div>
    <pre>
3
3
3
1
</pre>
   </div>
   <div class="input">
    <div class="title">
     Input
    </div>
    <pre>
1
0
2
1 1 -1
1 1 -1
</pre>
   </div>
   <div class="output">
    <div class="title">
     Output
    </div>
    <pre>
0
0
-1
</pre>
   </div>
  </div>
 </div>
 <div class="note">
  <div class="section-title">
   Note
  </div>
  <p>In the first test:</p>
  <ul> 
   <li> The initial sequence $a = (2, -1, 7, 3)$. Two sequences $b=(-3,-3,5,5),c=(5,2,2,-2)$ is a possible choice. </li>
   <li> After the first change $a = (2, -4, 4, 0)$. Two sequences $b=(-3,-3,5,5),c=(5,-1,-1,-5)$ is a possible choice. </li>
   <li> After the second change $a = (2, -4, 6, 2)$. Two sequences $b=(-4,-4,6,6),c=(6,0,0,-4)$ is a possible choice. </li>
  </ul>
 </div>
</div>