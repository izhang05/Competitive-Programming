<div class="problem-statement"> 
 <div class="header"> 
  <div class="title">
   E2. Астеризм (сложная версия)
  </div> 
  <div class="time-limit">
   <div class="property-title">
    ограничение по времени на тест
   </div>1 секунда
  </div> 
  <div class="memory-limit"> 
   <div class="property-title">
    ограничение по памяти на тест
   </div>256 мегабайт
  </div> 
  <div class="input-file"> 
   <div class="property-title">
    ввод
   </div>стандартный ввод
  </div> 
  <div class="output-file"> 
   <div class="property-title">
    вывод
   </div>стандартный вывод
  </div>
 </div> 
 <div> 
  <p> <span class="tex-font-style-bf">Это сложная версия задачи. Различие между версиями заключается в ограничениях на $n$ и $a_i$. Вы можете делать взломы, только если обе версии этой задачи сданы.</span></p> 
  <p>Сначала Aoi придумал следующую идею для задачи по программированию:</p> 
  <p>Yuzu девочка, которая коллекционирует конфеты. Изначально, у нее есть $x$ конфет. Также есть $n$ врагов, пронумерованных целыми числами от $1$ до $n$. Враг $i$ имеет $a_i$ конфет.</p> 
  <p>Yuzu хочет получить перестановку $P$. Перестановкой называется массив, состоящий из $n$ различных целых чисел от $1$ до $n$, расположенных в некотором порядке. Например, $\{2,3,1,5,4\}$ это перестановка, а $\{1,2,2\}$ это не перестановка (число $2$ встречается в массиве дважды) и $\{1,3,4\}$ тоже не является перестановкой (потому что $n=3$, но в массиве есть число $4$).</p> 
  <p>После этого, она проведет $n$ дуэлей с врагами по следующим правилам:</p> 
  <ul> 
   <li> Если Yuzu сейчас имеет <span class="tex-font-style-bf">не меньше</span> конфет, чем враг $P_i$, она побеждает в дуэли и <span class="tex-font-style-bf">получает $1$ конфету</span>. Иначе, она проигрывает дуэль и ничего не получает. </li> 
   <li> Конфета, которую получает Yuzu в случае победы, будет использоваться в следующих дуэлях. </li>
  </ul> 
  <p>Yuzu хочет <span class="tex-font-style-bf">победить во всех дуэлях</span>. Сколько существует возможных перестановок $P$, для которых это произойдет?</p> 
  <p>Эта задача была простой и неинтересной для Akari, друга Aoi. И Akari придумал следующую задачу, на основе описанной идеи:</p> 
  <p>Давайте определим $f(x)$ как количество возможных перестановок для целого числа $x$.</p> 
  <p>Вам дано число $n$, массив $a$ и <span class="tex-font-style-bf">простое число</span> $p \le n$. Назовем целое положительное число $x$ <span class="tex-font-style-bf">хорошим</span>, если значение $f(x)$ <span class="tex-font-style-bf">не</span> делится на $p$. Найдите <span class="tex-font-style-bf">все</span> хорошие числа $x$.</p> 
  <p>Решите задачу, предложенную Akari.</p>
 </div> 
 <div class="input-specification"> 
  <div class="section-title">
   Входные данные
  </div> 
  <p>В первой строке находится два целых числа $n$, $p$ $(2 \le p \le n \le 10^5)$. Гарантируется, что число $p$ является простым (оно имеет ровно два делителя $1$ и $p$).</p> 
  <p>Во второй строке находится $n$ целых чисел $a_1, a_2, \ldots, a_n$ $(1 \le a_i \le 10^9)$.</p>
 </div> 
 <div class="output-specification"> 
  <div class="section-title">
   Выходные данные
  </div> 
  <p>В первой строке выведите количество хороших чисел $x$.</p> 
  <p>Во второй строке выведите все хорошие числа $x$ <span class="tex-font-style-bf">в возрастающем порядке</span>.</p> 
  <p>Гарантируется, что количество хороших чисел $x$ не превосходит $10^5$.</p>
 </div> 
 <div class="sample-tests"> 
  <div class="section-title">
   Примеры
  </div> 
  <div class="sample-test"> 
   <div class="input"> 
    <div class="title">
     Входные данные
    </div> 
    <pre>
3 2
3 4 5
</pre>
   </div> 
   <div class="output"> 
    <div class="title">
     Выходные данные
    </div> 
    <pre>
1
3
</pre>
   </div> 
   <div class="input"> 
    <div class="title">
     Входные данные
    </div> 
    <pre>
4 3
2 3 5 6
</pre>
   </div> 
   <div class="output"> 
    <div class="title">
     Выходные данные
    </div> 
    <pre>
2
3 4
</pre>
   </div> 
   <div class="input"> 
    <div class="title">
     Входные данные
    </div> 
    <pre>
4 3
9 1 1 1
</pre>
   </div> 
   <div class="output"> 
    <div class="title">
     Выходные данные
    </div> 
    <pre>
0

</pre>
   </div> 
   <div class="input"> 
    <div class="title">
     Входные данные
    </div> 
    <pre>
3 2
1000000000 1 999999999
</pre>
   </div> 
   <div class="output"> 
    <div class="title">
     Выходные данные
    </div> 
    <pre>
1
999999998
</pre>
   </div>
  </div>
 </div> 
 <div class="note"> 
  <div class="section-title">
   Примечание
  </div> 
  <p>В первом тесте $p=2$.</p> 
  <ul> 
   <li> Если $x \le 2$ тогда нет ни одной перестановки, подходящей для Yuzu. Поэтому $f(x)=0$ для $x \le 2$. Заметим, что $0$ делится на $2$, поэтому ни одно число $x \leq 2$ не хорошее. </li> 
   <li> Если $x = 3$, то $\{1,2,3\}$ единственная подходящая для Yuzu перестановка. Тогда, $f(3)=1$, а значит число $3$ хорошее. </li> 
   <li> Если $x = 4$, то $\{1,2,3\} , \{1,3,2\} , \{2,1,3\} , \{2,3,1\}$ это все перестановки, подходящие для Yuzu. Тогда, $f(4)=4$, значит число $4$ не хорошее. </li> 
   <li> Если $x \ge 5$ , все $6$ перестановок подходят Yuzu. Тогда, $f(x)=6$ для всех $x \ge 5$. Значит ни одно число $x \ge 5$ не хорошее. </li>
  </ul> 
  <p>Значит единственное хорошее число это $3$.</p> 
  <p>В третьем тесте для всех целых положительных $x$ значение $f(x)$ делится на $p = 3$.</p>
 </div>
</div>